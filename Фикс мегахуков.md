## Было так. Но кажется много кода?

```jsx
import { Icons } from 'constants/icons'
import { Permissions } from 'constants/permissions'
import { default as CustomButton } from 'components/ui/Button'
import CustomAriaButton from 'components/ui/CustomAriaButton'
import CustomSVG from 'components/ui/CustomSVG'
import { useRef, useState } from 'react'
import { useAbac } from 'react-abac'
import { Menu, MenuItem, MenuTrigger, Popover } from 'react-aria-components'
import { useTranslation } from 'react-i18next'
import { useClickAway } from 'react-use'
import { ModalType } from 'stores/modalStore'
import { DocumentInfo } from 'models/documents/api'
import { cc } from 'utils/combineClasses'
import styles from './styles.module.scss'
import { useDocumentMenu } from './useDocumentMenu'

interface Props {
  documentInfo: DocumentInfo
}

const FileMenu = ({ documentInfo }: Props) => {
  const [showModal, closeModal] = useModalStore(state => [state.showModal, state.closeModal])
  const queryClient = useQueryClient()
  const navigate = useNavigate()

  const { mutate: createDocument } = useMutation({
    mutationFn: (data: CreateDocumentRequest) => postDocument(data),
    onSuccess: data => {
      queryClient.invalidateQueries({ queryKey: [QueryKeys.DOCUMENTS] })
      navigate({ to: Paths.DOCUMENT, params: { documentId: data.id } })
    }
  })

  const onCreateDocument = () => {
    createDocument({ title: 'New Document' })
  }

  const { mutate: deleteDocumentMutate } = useMutation({
    mutationFn: (id: string) => deleteDocument(id),
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: [QueryKeys.DOCUMENTS] })
      queryClient.invalidateQueries({ queryKey: [QueryKeys.DOCUMENTS_SEARCH] })
      navigate({ to: Paths.DOCUMENTS })
    }
  })

  const onDeleteDocument = () => {
    deleteDocumentMutate(documentInfo.id)
  }

  const { t } = useTranslation(['document', 'modals'])
  const { userHasPermissions } = useAbac()
  const { showModal, closeModal, onDeleteDocument, onCreateDocument } =
    useDocumentMenu(documentInfo)

  const [isOpen, setIsOpen] = useState(false)
  const triggerRef = useRef(null)

  useClickAway(triggerRef, () => {
    setIsOpen(false)
  })

  return (
    <MenuTrigger>
      <CustomAriaButton
        onPress={() => setIsOpen(state => !state)}
        ref={triggerRef}
        className={cc(styles.menuTrigger, isOpen && styles.active)}
      >
        {t('document:menu.file.title')}
      </CustomAriaButton>
      <Popover triggerRef={triggerRef} isNonModal isOpen={isOpen}>
        <Menu onAction={() => setIsOpen(false)} className={styles.menu}>
          <MenuItem onAction={onCreateDocument} className={styles.menuItem}>
            <CustomSVG className={cc(styles.menuOptionIcon)}>
              {Icons.document.createDocument}
            </CustomSVG>
            <p>{t('document:menu.file.createDocument')}</p>
          </MenuItem>
          <MenuItem
            onAction={() => showModal(ModalType.COPY_DOCUMENT, { documentInfo })}
            className={styles.menuItem}
          >
            <CustomSVG className={cc(styles.menuOptionIcon)}>
              {Icons.document.copyDocument}
            </CustomSVG>
            <p>{t('document:menu.file.copyDocument')}</p>
          </MenuItem>
          <MenuItem
            onAction={() => showModal(ModalType.SHARE, { title: documentInfo.title, documentInfo })}
            className={styles.menuItem}
          >
            <CustomSVG className={cc(styles.menuOptionIcon)}>
              {Icons.document.documentShare}
            </CustomSVG>
            <p>{t('document:menu.file.share')}</p>
          </MenuItem>
          {userHasPermissions(Permissions.DELETE_DOCUMENT, documentInfo.userRole) && (
            <MenuItem
              className={styles.menuItem}
              onAction={() => {
                showModal(ModalType.CUSTOM, {
                  title: t('document:menu.file.deleteDocument'),
                  children: (
                    <>
                      <p className={styles.modalMessage}>
                        {t('modals:moveToTrash.description', { title: document.title })}
                      </p>
                      <div className={styles.modalButtonsWrapper}>
                        <CustomButton variant="secondary" onPress={closeModal}>
                          {t('common:actions.cancel')}
                        </CustomButton>
                        <CustomButton
                          onPress={() => {
                            onDeleteDocument()
                            closeModal()
                          }}
                        >
                          {t('common:actions.delete')}
                        </CustomButton>
                      </div>
                    </>
                  )
                })
              }}
            >
              <CustomSVG className={styles.menuOptionIcon}>{Icons.common.trash}</CustomSVG>
              <p>{t('document:menu.file.deleteDocument')}</p>
            </MenuItem>
          )}
        </Menu>
      </Popover>
    </MenuTrigger>
  )
}

export default FileMenu

```



## Вот так стало, но проще ли?

```jsx
import { Icons } from 'constants/icons'
import { Permissions } from 'constants/permissions'
import { default as CustomButton } from 'components/ui/Button'
import CustomAriaButton from 'components/ui/CustomAriaButton'
import CustomSVG from 'components/ui/CustomSVG'
import { useRef, useState } from 'react'
import { useAbac } from 'react-abac'
import { Menu, MenuItem, MenuTrigger, Popover } from 'react-aria-components'
import { useTranslation } from 'react-i18next'
import { useClickAway } from 'react-use'
import { ModalType } from 'stores/modalStore'
import { DocumentInfo } from 'models/documents/api'
import { cc } from 'utils/combineClasses'
import styles from './styles.module.scss'
import { useDocumentMenu } from './useDocumentMenu'

interface Props {
  documentInfo: DocumentInfo
}

const FileMenu = ({ documentInfo }: Props) => {
  const { t } = useTranslation(['document', 'modals'])
  const { userHasPermissions } = useAbac()
  const { showModal, closeModal, onDeleteDocument, onCreateDocument } =
    useDocumentMenu(documentInfo)

  const [isOpen, setIsOpen] = useState(false)
  const triggerRef = useRef(null)

  useClickAway(triggerRef, () => {
    setIsOpen(false)
  })

  return (
    <MenuTrigger>
      <CustomAriaButton
        onPress={() => setIsOpen(state => !state)}
        ref={triggerRef}
        className={cc(styles.menuTrigger, isOpen && styles.active)}
      >
        {t('document:menu.file.title')}
      </CustomAriaButton>
      <Popover triggerRef={triggerRef} isNonModal isOpen={isOpen}>
        <Menu onAction={() => setIsOpen(false)} className={styles.menu}>
          <MenuItem onAction={onCreateDocument} className={styles.menuItem}>
            <CustomSVG className={cc(styles.menuOptionIcon)}>
              {Icons.document.createDocument}
            </CustomSVG>
            <p>{t('document:menu.file.createDocument')}</p>
          </MenuItem>
          <MenuItem
            onAction={() => showModal(ModalType.COPY_DOCUMENT, { documentInfo })}
            className={styles.menuItem}
          >
            <CustomSVG className={cc(styles.menuOptionIcon)}>
              {Icons.document.copyDocument}
            </CustomSVG>
            <p>{t('document:menu.file.copyDocument')}</p>
          </MenuItem>
          <MenuItem
            onAction={() => showModal(ModalType.SHARE, { title: documentInfo.title, documentInfo })}
            className={styles.menuItem}
          >
            <CustomSVG className={cc(styles.menuOptionIcon)}>
              {Icons.document.documentShare}
            </CustomSVG>
            <p>{t('document:menu.file.share')}</p>
          </MenuItem>
          {userHasPermissions(Permissions.DELETE_DOCUMENT, documentInfo.userRole) && (
            <MenuItem
              className={styles.menuItem}
              onAction={() => {
                showModal(ModalType.CUSTOM, {
                  title: t('document:menu.file.deleteDocument'),
                  children: (
                    <>
                      <p className={styles.modalMessage}>
                        {t('modals:moveToTrash.description', { title: document.title })}
                      </p>
                      <div className={styles.modalButtonsWrapper}>
                        <CustomButton variant="secondary" onPress={closeModal}>
                          {t('common:actions.cancel')}
                        </CustomButton>
                        <CustomButton
                          onPress={() => {
                            onDeleteDocument()
                            closeModal()
                          }}
                        >
                          {t('common:actions.delete')}
                        </CustomButton>
                      </div>
                    </>
                  )
                })
              }}
            >
              <CustomSVG className={styles.menuOptionIcon}>{Icons.common.trash}</CustomSVG>
              <p>{t('document:menu.file.deleteDocument')}</p>
            </MenuItem>
          )}
        </Menu>
      </Popover>
    </MenuTrigger>
  )
}

export default FileMenu

```

```jsx
import { QueryKeys } from 'constants/queryKeys'
import { Paths } from 'constants/routes'
import { useMutation, useQueryClient } from '@tanstack/react-query'
import { useNavigate } from '@tanstack/react-router'
import { useModalStore } from 'stores/modalStore'
import { deleteDocument, postDocument } from 'api/documents'
import { CreateDocumentRequest, DocumentInfo } from 'models/documents/api'

export const useDocumentMenu = (documentInfo: DocumentInfo) => {
  const [showModal, closeModal] = useModalStore(state => [state.showModal, state.closeModal])
  const queryClient = useQueryClient()
  const navigate = useNavigate()

  const { mutate: createDocument } = useMutation({
    mutationFn: (data: CreateDocumentRequest) => postDocument(data),
    onSuccess: data => {
      queryClient.invalidateQueries({ queryKey: [QueryKeys.DOCUMENTS] })
      navigate({ to: Paths.DOCUMENT, params: { documentId: data.id } })
    }
  })

  const onCreateDocument = () => {
    createDocument({ title: 'New Document' })
  }

  const { mutate: deleteDocumentMutate } = useMutation({
    mutationFn: (id: string) => deleteDocument(id),
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: [QueryKeys.DOCUMENTS] })
      queryClient.invalidateQueries({ queryKey: [QueryKeys.DOCUMENTS_SEARCH] })
      navigate({ to: Paths.DOCUMENTS })
    }
  })

  const onDeleteDocument = () => {
    deleteDocumentMutate(documentInfo.id)
  }

  return {
    showModal,
    closeModal,
    onDeleteDocument,
    onCreateDocument
  }
}
```


## Игра в наперстки продолжается!
```js
import { Icons } from 'constants/icons'
import { Permissions } from 'constants/permissions'
import { default as CustomButton } from 'components/ui/Button'
import CustomAriaButton from 'components/ui/CustomAriaButton'
import CustomSVG from 'components/ui/CustomSVG'
import { useRef, useState } from 'react'
import { useAbac } from 'react-abac'
import { Menu, MenuItem, MenuTrigger, Popover } from 'react-aria-components'
import { useTranslation } from 'react-i18next'
import { useClickAway } from 'react-use'
import { ModalType } from 'stores/modalStore'
import { DocumentInfo } from 'models/documents/api'
import { cc } from 'utils/combineClasses'
import styles from './styles.module.scss'
import { useDocumentMenu } from './useDocumentMenu'

interface Props {
  documentInfo: DocumentInfo
}

const FileMenu = ({ documentInfo }: Props) => {
  const { t } = useTranslation(['document', 'modals'])
  const { userHasPermissions } = useAbac()
  const { showModal, closeModal, showModalCloseDocument, onDeleteDocument, onCreateDocument } =
    useDocumentMenu(documentInfo)

  const [isOpen, setIsOpen] = useState(false)
  const triggerRef = useRef(null)

  useClickAway(triggerRef, () => {
    setIsOpen(false)
  })

  return (
    <MenuTrigger>
      <CustomAriaButton
        onPress={() => setIsOpen(state => !state)}
        ref={triggerRef}
        className={cc(styles.menuTrigger, isOpen && styles.active)}
      >
        {t('document:menu.file.title')}
      </CustomAriaButton>
      <Popover triggerRef={triggerRef} isNonModal isOpen={isOpen}>
        <Menu onAction={() => setIsOpen(false)} className={styles.menu}>
		  <MenuItem
	        icon={Icons.common.createDocument}
	        text={t('document:menu.file.createDocument')}
            onAction={onCreateDocument}
	      />	
		  
		  <MenuItem
	        icon={Icons.common.copyDocument}
	        text={t('document:menu.file.copyDocument')}
            onAction={() => showModal(ModalType.COPY_DOCUMENT, { documentInfo })}
	      />	
		  <MenuItem
	        icon={Icons.common.documentShare}
	        text={t('document:menu.file.share')}
            onAction={() => showModal(ModalType.SHARE, { title: documentInfo.title, documentInfo })}
	      />	
          {userHasPermissions(Permissions.DELETE_DOCUMENT, documentInfo.userRole) && (
		  <MenuItem
	        icon={Icons.common.trash}
	        text={t('document:menu.file.deleteDocument')}
            onAction={showModalCloseDocument}
	      />	
        </Menu>
      </Popover>
    </MenuTrigger>
  )
}

export default FileMenu
```


```jsx
import { QueryKeys } from 'constants/queryKeys'
import { Paths } from 'constants/routes'
import { useMutation, useQueryClient } from '@tanstack/react-query'
import { useNavigate } from '@tanstack/react-router'
import { useModalStore } from 'stores/modalStore'
import { deleteDocument, postDocument } from 'api/documents'
import { CreateDocumentRequest, DocumentInfo } from 'models/documents/api'

export const useDocumentMenu = (documentInfo: DocumentInfo) => {
  const [showModal, closeModal] = useModalStore(state => [state.showModal, state.closeModal])
  const queryClient = useQueryClient()
  const navigate = useNavigate()

  const { mutate: createDocument } = useMutation({
    mutationFn: (data: CreateDocumentRequest) => postDocument(data),
    onSuccess: data => {
      queryClient.invalidateQueries({ queryKey: [QueryKeys.DOCUMENTS] })
      navigate({ to: Paths.DOCUMENT, params: { documentId: data.id } })
    }
  })

  const onCreateDocument = () => {
    createDocument({ title: 'New Document' })
  }

  const { mutate: deleteDocumentMutate } = useMutation({
    mutationFn: (id: string) => deleteDocument(id),
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: [QueryKeys.DOCUMENTS] })
      queryClient.invalidateQueries({ queryKey: [QueryKeys.DOCUMENTS_SEARCH] })
      navigate({ to: Paths.DOCUMENTS })
    }
  })

  const onDeleteDocument = () => {
    deleteDocumentMutate(documentInfo.id)
  }
  
  const showModalCloseDocument = () => showModal(ModalType.CUSTOM, {
                  title: t('document:menu.file.deleteDocument'),
                  children: (
                    <>
                      <p className={styles.modalMessage}>
                        {t('modals:moveToTrash.description', { title: document.title })}
                      </p>
                      <div className={styles.modalButtonsWrapper}>
                        <CustomButton variant="secondary" onPress={closeModal}>
                          {t('common:actions.cancel')}
                        </CustomButton>
                        <CustomButton
                          onPress={() => {
                            onDeleteDocument()
                            closeModal()
                          }}
                        >
                          {t('common:actions.delete')}
                        </CustomButton>
                      </div>
                    </>
                  )
                })
              }}

  return {
    showModal,
    closeModal,
	showModalCloseDocument,
    onDeleteDocument,
    onCreateDocument
  }
}
```

```js
import { Icons } from 'constants/icons'
import CustomSVG from 'components/ui/CustomSVG'
import { forwardRef, type ReactElement } from 'react'
import { MenuItem as MenuItemAria } from 'react-aria-components'
import styles from '../styles.module.scss'

interface Props {
  text: string
  icon?: ReactElement
  onAction?: () => void
  arrayLeft?: boolean
}

const MenuItem = forwardRef<HTMLElement, Props>(({ onAction, icon, text, arrayLeft }, ref) => {
  return (
    <MenuItemAria onAction={onAction} className={styles.menuItem} ref={ref}>
      {icon && <CustomSVG className={styles.menuOptionIcon}>{icon}</CustomSVG>}
      <p>{text}</p>
      {arrayLeft && (
        <CustomSVG className={styles.chevron}>{Icons.arrows.chevronArrowRight}</CustomSVG>
      )}
    </MenuItemAria>
  )
})

MenuItem.displayName = 'MenuItem'

export default MenuItem
```